# This rule disables ModSecurity processing for CORS preflight requests (OPTIONS with an Origin header).
# This prevents false positives and unnecessary blocking of legitimate CORS preflight requests.
SecRule REQUEST_METHOD "OPTIONS" "id:900150,phase:1,pass,nolog,ctl:ruleEngine=Off,chain"
    SecRule REQUEST_HEADERS:Origin "." "t:none,chain"
    SecRule TX:cors_preflight_disable "@eq 1"