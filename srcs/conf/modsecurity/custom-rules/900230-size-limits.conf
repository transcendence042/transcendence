# 900230 â€” Enforce argument and body size limits
# Reads values set in crs-setup.conf (tx.max_num_args, tx.arg_length, etc.)

SecRule &ARGS "@gt %{tx.max_num_args}" \
    "id:900231,phase:2,deny,status:413,log,msg:'Too many arguments'"

SecRule ARGS_NAMES "@rx .+" \
    "chain,id:900232,phase:2,deny,status:413,log,msg:'Argument name too long'"
    SecRule MATCHED_VAR_LENGTH "@gt %{tx.arg_name_length}"

SecRule ARGS "@rx .+" \
    "chain,id:900233,phase:2,deny,status:413,log,msg:'Argument value too long'"
    SecRule MATCHED_VAR_LENGTH "@gt %{tx.arg_length}"

SecRule &ARGS_COMBINED_SIZE "@gt %{tx.total_arg_length}" \
    "id:900234,phase:2,deny,status:413,log,msg:'Total argument size exceeded'"

SecRule REQUEST_BODY_LENGTH "@gt %{tx.total_arg_length}" \
    "id:900235,phase:2,deny,status:413,log,msg:'Request body too large (urlencoded/form)'"

SecRule REQUEST_BODY_LENGTH "@gt %{tx.combined_file_sizes}" \
    "id:900236,phase:2,deny,status:413,log,msg:'Combined file sizes too large'"
