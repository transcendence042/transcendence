# This rule blocks requests with a Host header not in the allowed list.
# The allowed hostnames are defined in crs-setup.conf as tx.allowed_hostnames.
SecRule REQUEST_HEADERS:Host "!@rx ^(?:%{tx.allowed_hostnames})$" \
    "id:900600,phase:1,deny,status:400,log,msg:'Host header not allowed: %{REQUEST_HEADERS.Host}'"

# These rules block common XSS and SQL Injection attempts in request parameters.
# - Block XSS payloads such as <script>, onerror, onload, alert( in any argument.
# - Block basic SQL injection patterns using 'or', 'and', '=', or 'like'.
# - Block suspicious use of quotes in arguments that may indicate SQL injection.
SecRule ARGS "@rx %{tx.xss_pattern}" "id:900601,phase:2,deny,status:403,msg:'XSS attempt blocked'"
SecRule ARGS "@rx %{tx.sqli_pattern}" "id:900602,phase:2,deny,status:403,msg:'SQLi attempt blocked'"
SecRule ARGS "@rx %{tx.sqli_quote_pattern}" "id:900603,phase:2,deny,status:403,msg:'SQLi quote attempt blocked'"
