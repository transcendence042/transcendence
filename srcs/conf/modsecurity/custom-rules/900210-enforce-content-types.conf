# Default in /api: application/json or x-www-form-urlencoded (e.g. login)
SecRule REQUEST_URI "@beginsWith /api/" "id:900210,phase:2,deny,status:415,log,chain,msg:'Content-Type not allowed in /api'"
    SecRule REQUEST_METHOD "@rx ^(?:POST|PUT|PATCH|DELETE)$" "t:none,chain"
    SecRule REQUEST_HEADERS:Content-Type "!@rx ^(?:application/json|application/x-www-form-urlencoded)\b"

# If you have /api/upload that uses multipart/form-data, allow that Content-Type:
SecRule REQUEST_URI "^/api/upload" "id:900211,phase:2,pass,nolog,ctl:ruleRemoveById=900210"
