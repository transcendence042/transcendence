# Only GET in / (SPA frontend). Block POST/PUT/DELETE here.
SecRule REQUEST_URI "^/$" "id:900200,phase:1,deny,status:405,t:none,chain,msg:'Method not allowed in /'"
    SecRule REQUEST_METHOD "!@rx ^(?:GET|HEAD)$"

# For /api/ only allow GET/POST by default.
SecRule REQUEST_URI "@beginsWith /api/" "id:900201,phase:1,deny,status:405,t:none,chain,msg:'Method not allowed in /api/'"
    SecRule REQUEST_METHOD "!@rx ^(?:GET|HEAD|POST)$"

# Example: If you have endpoints that support PUT/PATCH/DELETE, add whitelists:
# SecRule REQUEST_URI "^/api/profile$" "id:900202,phase:1,pass,ctl:ruleRemoveTargetById=900201;REQUEST_METHOD"
