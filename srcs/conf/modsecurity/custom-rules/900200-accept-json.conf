# These rules block API requests to /api/ endpoints if the Accept header is missing or does not include application/json.
# This enforces that clients must explicitly accept JSON responses from the API.
SecRule REQUEST_URI "@beginsWith /api/" "id:900200,phase:1,deny,status:406,log,msg:'API: missing Accept header (%{tx.api_accept} required)',chain"
SecRule &REQUEST_HEADERS:Accept "@eq 0" "t:none"

SecRule REQUEST_URI "@beginsWith /api/" "id:900201,phase:1,deny,status:406,log,msg:'API: invalid Accept header (%{tx.api_accept} required)',chain"
SecRule REQUEST_HEADERS:Accept "!@rx %{tx.api_accept}\b" "t:none"