# Static whitelist (only record, do not block)
SecRule REQUEST_FILENAME "@rx \.(?:css|js|png|jpg|jpeg|gif|svg|ico|webp|woff2?|ttf|map)$" \
    "id:900120,phase:1,pass,nolog,ctl:ruleEngine=DetectionOnly"

# Health checks without WAF
SecRule REQUEST_URI "@beginsWith /healthz" "id:900121,phase:1,pass,ctl:ruleEngine=DetectionOnly,nolog"
SecRule REQUEST_URI "@beginsWith /ping"    "id:900122,phase:1,pass,ctl:ruleEngine=DetectionOnly,nolog"

# Allow CORS preflight (OPTIONS) without inspection if it looks like preflight
SecRule REQUEST_METHOD "OPTIONS" "id:900123,phase:1,pass,nolog,ctl:ruleEngine=Off,chain"
    SecRule REQUEST_HEADERS:Origin "." "t:none,chain"
    SecRule REQUEST_HEADERS:Access-Control-Request-Method "." "t:none"
