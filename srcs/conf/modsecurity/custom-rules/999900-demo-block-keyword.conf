# This rule blocks requests containing a demo keyword to confirm ModSecurity is active.
SecRule ARGS|REQUEST_BODY|REQUEST_URI "@rx %{tx.demo_block_keyword}" \
    "id:999900,phase:2,deny,status:418,log,msg:'Demo block keyword detected: %{tx.demo_block_keyword}'"

# This rule blocks requests containing the keyword 'malicious' (case-insensitive) for security testing
#SecRule ARGS|REQUEST_BODY|REQUEST_URI "@rx (?i)malicious" \
#    "id:999901,phase:2,deny,status:403,log,msg:'Malicious keyword detected in request (case-insensitive)'"




# This rule blocks requests containing the keyword 'malicious' for security testing
SecRule ARGS "@contains malicious" \
    "id:999901,phase:2,deny,status:403,log,msg:'Malicious keyword detected in arguments'"

# Alternative rule using regex (backup)
SecRule ARGS "@rx (?i)malicious" \
    "id:999902,phase:2,deny,status:403,log,msg:'Malicious keyword detected in arguments (regex)'"

# Simple test rule
SecRule ARGS:q "@streq malicious" \
    "id:999903,phase:2,deny,status:403,log,msg:'Simple malicious test rule activated'"