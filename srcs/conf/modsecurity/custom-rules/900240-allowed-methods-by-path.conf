# 900240 - Allowed methods by path

# /api/auth/login -> POST only
SecRule REQUEST_URI "^/api/auth/login$" "id:900241,phase:1,deny,status:405,log,chain,msg:'Restrict methods on /api/auth/login'"
SecRule REQUEST_METHOD "!@rx ^(?:%{tx.allowed_methods_auth_login})$"

# /api/upload -> POST only
SecRule REQUEST_URI "^/api/upload$" "id:900242,phase:1,deny,status:405,log,chain,msg:'Restrict methods on /api/upload'"
SecRule REQUEST_METHOD "!@rx ^(?:%{tx.allowed_methods_upload})$"

# Everything else (NO API) -> GET, HEAD, OPTIONS
SecRule REQUEST_URI "!@beginsWith /api/" "id:900243,phase:1,deny,status:405,log,chain,msg:'Restrict methods on non-API paths'"
SecRule REQUEST_METHOD "!@rx ^(?:%{tx.allowed_methods_non_api})$"
