# This rule blocks API requests to /api/ endpoints unless the Content-Type header is application/json for POST, PUT, PATCH, or DELETE methods.
SecRule REQUEST_URI "@beginsWith /api/" "id:900120,phase:1,deny,status:415,log,msg:'API requires application/json requests',chain"
SecRule REQUEST_METHOD "@rx ^(?:POST|PUT|PATCH|DELETE)$" "chain"
SecRule REQUEST_HEADERS:Content-Type "!@rx ^%{tx.api_content_type}\b" "t:none"