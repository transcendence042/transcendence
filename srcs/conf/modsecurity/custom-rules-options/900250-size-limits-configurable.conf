# These rules enforce argument and body size limits using configurable TX variables.
# - Block requests with more than tx.max_num_args arguments.
# - Block argument names longer than tx.arg_name_length.
# - Block argument values longer than tx.arg_length.
# - Block if total argument size exceeds tx.total_arg_length.
# - Block if request body or combined file sizes exceed defined limits.

SecRule &ARGS "@gt %{tx.max_num_args}" "id:900251,phase:2,deny,status:413,log,msg:'Too many arguments'"

SecRule ARGS_NAMES "@rx .+" "id:900252,phase:2,deny,status:413,log,msg:'Argument name too long',chain"
SecRule MATCHED_VAR "@gt %{tx.arg_name_length}" "t:length"

SecRule ARGS "@rx .+" "id:900253,phase:2,deny,status:413,log,msg:'Argument value too long',chain"
SecRule MATCHED_VAR "@gt %{tx.arg_length}" "t:length"

SecRule &ARGS_COMBINED_SIZE "@gt %{tx.total_arg_length}" "id:900254,phase:2,deny,status:413,log,msg:'Total argument size exceeded'"

SecRule REQUEST_BODY_LENGTH "@gt %{tx.total_arg_length}" "id:900255,phase:2,deny,status:413,log,msg:'Request body too large (urlencoded/form)'"
SecRule REQUEST_BODY_LENGTH "@gt %{tx.combined_file_sizes}" "id:900236,phase:2,deny,status:413,log,msg:'Combined file sizes too large'"
